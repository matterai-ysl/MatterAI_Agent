# ADK Web å¤šæ¨¡æ€ PDF å¤„ç†æµ‹è¯•

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `test.py` | ä¸»æµ‹è¯•è„šæœ¬ï¼ŒåŒ…å« Agent å’Œå·¥å…·å®šä¹‰ |
| `test_pdf_guide.md` | è¯¦ç»†ä½¿ç”¨æŒ‡å—å’ŒæŠ€æœ¯æ–‡æ¡£ |
| `run_test.sh` | Linux/Mac å¯åŠ¨è„šæœ¬ |
| `run_test.bat` | Windows å¯åŠ¨è„šæœ¬ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ 1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

**Linux/Mac:**
```bash
./run_test.sh
```

**Windows:**
```cmd
run_test.bat
```

### æ–¹å¼ 2: ç›´æ¥è¿è¡Œ

```bash
# 1. å®‰è£…ä¾èµ–
pip install google-adk requests python-dotenv

# 2. ï¼ˆå¯é€‰ï¼‰å®‰è£…æ–‡æœ¬æå–å·¥å…·
pip install PyPDF2

# 3. å¯åŠ¨ ADK Web
adk web test.py
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡ (.env)

```env
# ä½¿ç”¨ OpenAI API
OPENAI_API_KEY=sk-xxx...
BASE_URL=https://api.openai.com/v1

# æˆ–ä½¿ç”¨ Google Gemini
GOOGLE_API_KEY=AIza...
```

### ä¿®æ”¹æ¨¡å‹é…ç½®

ç¼–è¾‘ `test.py` ç¬¬ 28-36 è¡Œï¼š

```python
# å½“å‰é…ç½®ï¼ˆOpenAIï¼‰
model = LiteLlm(
    model="openai/gpt-4o",
    api_base=os.getenv("BASE_URL"),
    api_key=os.getenv("OPENAI_API_KEY")
)

# åˆ‡æ¢åˆ° Geminiï¼ˆå–æ¶ˆæ³¨é‡Šï¼‰
# from google.adk.models import GeminiModel
# model = GeminiModel(
#     model="gemini-1.5-pro",
#     api_key=os.getenv("GOOGLE_API_KEY")
# )
```

## ğŸ“ æµ‹è¯•ç¤ºä¾‹

### 1. åˆ†æåœ¨çº¿ PDF

åœ¨ ADK Web ç•Œé¢è¾“å…¥ï¼š

```
è¯·åˆ†æè¿™ä¸ª PDFï¼šhttps://arxiv.org/pdf/2301.00001.pdf
```

Agent ä¼šï¼š
1. âœ… ä¸‹è½½ PDF
2. âœ… ä¿å­˜ä¸º Artifact
3. âœ… ä½¿ç”¨å¤šæ¨¡æ€èƒ½åŠ›ç†è§£å†…å®¹
4. âœ… å›ç­”ä½ çš„é—®é¢˜

### 2. ä¸Šä¼ æœ¬åœ° PDF

```
[ä¸Šä¼ æ–‡ä»¶: paper.pdf]

è¿™ç¯‡è®ºæ–‡çš„ä¸»è¦ç»“è®ºæ˜¯ä»€ä¹ˆï¼Ÿ
```

### 3. å¤šè½®å¯¹è¯

```
ä½ : è¯·åˆ†æ https://example.com/paper.pdf
AI: âœ… å·²åˆ†æï¼ŒPDF ä¿å­˜ä¸º Artifact: pdf_123456789

ä½ : æå–æ–‡æ¡£ä¸­çš„æ‰€æœ‰è¡¨æ ¼æ•°æ®
AI: [åŸºäºå·²ä¿å­˜çš„ PDF å›ç­”]

ä½ : æ€»ç»“ç¬¬3ç« çš„å†…å®¹
AI: [ç»§ç»­ä½¿ç”¨åŒä¸€ä¸ª PDF]
```

### 4. æå–å…ƒä¿¡æ¯

```
è·å– PDF pdf_123456789 çš„è¯¦ç»†ä¿¡æ¯
```

è¾“å‡ºï¼š
```json
{
  "page_count": 12,
  "file_size": 2456789,
  "preview": "æ‘˜è¦ï¼šæœ¬ç ”ç©¶..."
}
```

## ğŸ› ï¸ å¯ç”¨å·¥å…·

### 1. `analyze_pdf_from_url`

**æè¿°:** ä» URL ä¸‹è½½å¹¶åˆ†æ PDF

**å‚æ•°:**
- `url` (str): PDF æ–‡ä»¶çš„ URL

**è¿”å›:**
```json
{
  "status": "success",
  "artifact_name": "pdf_123456789",
  "file_size": 2456789,
  "version": "v1"
}
```

### 2. `load_artifacts`

**æè¿°:** åŠ è½½ä¹‹å‰ä¿å­˜çš„ Artifactï¼ˆADK å†…ç½®ï¼‰

**å‚æ•°:**
- `artifact_name` (str): Artifact åç§°

### 3. `extract_pdf_info`

**æè¿°:** æå– PDF å…ƒä¿¡æ¯

**å‚æ•°:**
- `artifact_name` (str): Artifact åç§°

**è¿”å›:**
```json
{
  "page_count": 12,
  "file_size": 2456789,
  "preview": "å‰1000å­—ç¬¦..."
}
```

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯ A: å­¦æœ¯è®ºæ–‡åˆ†æ

```
ä½ : è¯·åˆ†æè¿™ç¯‡è®ºæ–‡ï¼šhttps://arxiv.org/pdf/2301.00001.pdf

é—®é¢˜ï¼š
1. è®ºæ–‡çš„ç ”ç©¶æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ
2. ä¸»è¦è´¡çŒ®æœ‰å“ªäº›ï¼Ÿ
3. å®éªŒç»“æœå¦‚ä½•ï¼Ÿ
```

### åœºæ™¯ B: æŠ€æœ¯æ–‡æ¡£æŸ¥è¯¢

```
ä½ : [ä¸Šä¼  API æ–‡æ¡£.pdf]

é—®é¢˜ï¼š
1. å¦‚ä½•ä½¿ç”¨è®¤è¯åŠŸèƒ½ï¼Ÿ
2. æœ‰å“ªäº›å¯ç”¨çš„æ¥å£ï¼Ÿ
3. é”™è¯¯ç æœ‰å“ªäº›ï¼Ÿ
```

### åœºæ™¯ C: å¤šæ–‡æ¡£å¯¹æ¯”

```
ä½ : åˆ†æ paper1.pdf
ä½ : åˆ†æ paper2.pdf
ä½ : å¯¹æ¯”è¿™ä¸¤ç¯‡è®ºæ–‡çš„æ–¹æ³•å·®å¼‚
```

## ğŸ“Š æŠ€æœ¯åŸç†

### Artifact å­˜å‚¨æœºåˆ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PDF Binary    â”‚
â”‚  (application/  â”‚
â”‚      pdf)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ types.Part(inline_data=...)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Artifact     â”‚
â”‚  - name         â”‚
â”‚  - version      â”‚
â”‚  - data         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ load_artifact()
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gemini Model   â”‚
â”‚ ç›´æ¥ç†è§£ PDF å†…å®¹ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸ºä»€ä¹ˆä¸éœ€è¦ PyPDF2ï¼Ÿ

**ä¼ ç»Ÿæ–¹å¼:**
```
PDF â†’ PyPDF2 â†’ æ–‡æœ¬ â†’ LLM
```

**Gemini å¤šæ¨¡æ€:**
```
PDF â†’ Gemini (ç›´æ¥ç†è§£ï¼)
```

**ä¼˜åŠ¿:**
- âœ… ä¿ç•™åŸå§‹æ ¼å¼
- âœ… æ”¯æŒå›¾è¡¨ã€è¡¨æ ¼
- âœ… ç†è§£å¸ƒå±€ç»“æ„
- âœ… æ— éœ€é¢å¤–ä¾èµ–

**PyPDF2 çš„ç”¨é€”:**
- âš™ï¸ æå–å…ƒä¿¡æ¯ï¼ˆé¡µæ•°ã€å¤§å°ï¼‰
- âš™ï¸ ç”Ÿæˆæ–‡æœ¬é¢„è§ˆ
- âš™ï¸ å¯é€‰åŠŸèƒ½ï¼Œéå¿…éœ€

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ‰¾ä¸åˆ° adk å‘½ä»¤

**è§£å†³:**
```bash
pip install google-adk
```

### é—®é¢˜ 2: API Key é”™è¯¯

**æ£€æŸ¥:**
```bash
cat .env
# ç¡®è®¤ API Key æ­£ç¡®
```

### é—®é¢˜ 3: æ— æ³•ä¸‹è½½ PDF

**åŸå› :** 
- URL æ— æ•ˆ
- ç½‘ç»œé™åˆ¶
- æ–‡ä»¶éœ€è¦è®¤è¯

**è§£å†³:**
- ä½¿ç”¨å…¬å¼€å¯è®¿é—®çš„ URL
- æˆ–ä¸Šä¼ æœ¬åœ°æ–‡ä»¶

### é—®é¢˜ 4: å†…å­˜ä¸è¶³

**PDF æ–‡ä»¶è¿‡å¤§æ—¶:**

ç¼–è¾‘ `test.py`ï¼Œæ·»åŠ å¤§å°é™åˆ¶ï¼š

```python
MAX_FILE_SIZE = 10 * 1024 * 1024  # 10MB

if len(pdf_content) > MAX_FILE_SIZE:
    return {
        "status": "error",
        "message": "æ–‡ä»¶å¤ªå¤§ï¼Œè¯·ä¸Šä¼ å°äº 10MB çš„æ–‡ä»¶"
    }
```

## ğŸ“š æ‰©å±•å¼€å‘

### æ·»åŠ æ–°å·¥å…·

åœ¨ `test.py` ä¸­æ·»åŠ ï¼š

```python
async def summarize_pdf(artifact_name: str, tool_context: ToolContext) -> dict:
    """æ€»ç»“ PDF å†…å®¹"""
    artifact = await tool_context.load_artifact(artifact_name)
    
    # å¤„ç†é€»è¾‘...
    
    return {"summary": "..."}

# æ·»åŠ åˆ° Agent å·¥å…·åˆ—è¡¨
agent = LlmAgent(
    tools=[
        load_artifacts,
        analyze_pdf_from_url,
        extract_pdf_info,
        summarize_pdf,  # æ–°å·¥å…·
    ]
)
```

### é›†æˆåˆ°ç”Ÿäº§ç¯å¢ƒ

å‚è€ƒ `main.py` çš„å®ç°ï¼š
1. ä½¿ç”¨ DatabaseSessionServiceï¼ˆæŒä¹…åŒ–ä¼šè¯ï¼‰
2. ä½¿ç”¨ GcsArtifactServiceï¼ˆäº‘å­˜å‚¨ï¼‰
3. æ·»åŠ ç”¨æˆ·è®¤è¯
4. å®ç°æƒé™æ§åˆ¶

## ğŸ”— ç›¸å…³èµ„æº

- [è¯¦ç»†æŠ€æœ¯æ–‡æ¡£](./test_pdf_guide.md)
- [Google ADK å®˜æ–¹æ–‡æ¡£](https://ai.google.dev/adk)
- [Gemini API æ–‡æ¡£](https://ai.google.dev/gemini-api)
- [ä¸»é¡¹ç›®æ–‡æ¡£](./docs/æŠ€æœ¯è®¾è®¡è¯´æ˜.md)

## ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿

| ä¼ ç»Ÿæ–¹å¼ | ADK + Gemini å¤šæ¨¡æ€ |
|---------|-------------------|
| âŒ éœ€è¦ PyPDF2 è§£æ | âœ… ç›´æ¥ç†è§£ PDF |
| âŒ ä¸¢å¤±æ ¼å¼ä¿¡æ¯ | âœ… ä¿ç•™åŸå§‹å¸ƒå±€ |
| âŒ å›¾è¡¨æ— æ³•å¤„ç† | âœ… æ”¯æŒå¤šæ¨¡æ€å†…å®¹ |
| âŒ ä»£ç å¤æ‚ | âœ… ç®€æ´ä¼˜é›… |

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **è¿è¡Œæµ‹è¯•:** `./run_test.sh`
2. **æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£:** [test_pdf_guide.md](./test_pdf_guide.md)
3. **é›†æˆåˆ°é¡¹ç›®:** å‚è€ƒ `main.py` å®ç°
4. **æ·»åŠ æ›´å¤šåŠŸèƒ½:** è‡ªå®šä¹‰å·¥å…·å¼€å‘

---

**å¼€å§‹æµ‹è¯•å§ï¼** ğŸš€

```bash
./run_test.sh
```

æµè§ˆå™¨æ‰“å¼€ â†’ ä¸Šä¼  PDF â†’ å¼€å§‹å¯¹è¯ï¼

